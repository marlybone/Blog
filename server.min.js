const express=require("express"),app=express(),md=require("markdown-it")(),fs=require("fs"),path=require("path"),mimeTypes=require("mime-types"),marked=require("marked")["marked"],createDOMPurify=require("dompurify"),JSDOM=require("jsdom")["JSDOM"],matter=require("gray-matter"),helmet=require("helmet"),window=new JSDOM("").window,DOMPurify=createDOMPurify(window),publicDir=path.join(__dirname,"public");app.use("/Views",express.static(path.join(__dirname,"Views"))),app.use(express.static(publicDir)),app.use(express.urlencoded({extended:!1})),app.set("view engine","ejs"),app.use(helmet()),app.get("/",(e,r)=>{const i=[];fs.readdirSync("./public/Content",{withFileTypes:!0}).filter(e=>e.isDirectory()).map(e=>e.name).forEach(e=>{var r=`./public/Content/${e}/index.md`,r=fs.readFileSync(r,"utf8"),r=matter(r)["data"],r={...r,slug:e};i.push(r)}),r.render("index",{blogPosts:i})}),app.get("/blog/:slug",(e,r)=>{var e=e.params["slug"],i=`./public/Content/${e}/index.md`,i=fs.readFileSync(i,"utf-8"),{data:i,content:t}=matter(i),t=marked.parse(t),t=DOMPurify.sanitize(t),e={slug:e,...i};r.render("blog",{post:e,html:t})}),app.get("/about",(e,r)=>{r.render("about")}),app.use(function(e,r,i){r.status(404),r.render("404")}),app.listen(5e3,()=>{console.log("Server is running on port 5000")});